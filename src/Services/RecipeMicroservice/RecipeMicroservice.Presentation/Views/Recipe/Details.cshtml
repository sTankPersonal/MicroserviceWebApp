@using RecipeMicroservice.Presentation
@using RecipeMicroservice.Presentation.Models
@using RecipeMicroservice.Presentation.Models.Recipe
@using RecipeMicroservice.Presentation.Models.RecipeCategory
@using RecipeMicroservice.Presentation.Models.RecipeIngredient
@model RecipeViewModel
@{
    ViewData["Title"] = "Recipe Details";
}
<style>
    ul, ol {
        list-style: none;
        padding-left: 0;
        margin-left: 0;
    }
</style>
<h2>Recipe Details - @Model.Name</h2>

<p>
    <strong>Prep Time:</strong> @(Model.PrepTimeInMinutes / 60)h @(Model.PrepTimeInMinutes % 60)min<br />
    <strong>Cook Time:</strong> @(Model.CookTimeInMinutes / 60)h @(Model.CookTimeInMinutes % 60)min<br />
    <strong>Servings:</strong> @(Model.Servings)<br />
</p>

<h4>Categories</h4>
@if (Model.Categories.IsEmpty)
{
    <p>No categories listed.</p>
}
else
{
    <ul>
        @foreach (RecipeCategoryViewModel category in Model.Categories.Items)
        {
            <li>
                @category.CategoryName
            </li>
        }
    </ul>
}


<h4>Ingredients</h4>
@if (Model.Ingredients.IsEmpty)
{
    <p>No ingredients listed.</p>
}
else
{
    <ul>
        @foreach (RecipeIngredientViewModel ingredient in Model.Ingredients.Items)
        {
            <li>
                <input type="checkbox" class="strike-toggle" />
                <span>@ingredient.FormattedQuantity @ingredient.UnitName @ingredient.IngredientName</span>
            </li>
        }
    </ul>
}


<h4>Steps</h4>
@if (Model.Instructions.IsEmpty)
{
    <p>No instructions listed.</p>
}
else
{
    <ol>
        @foreach (var step in Model.Instructions.Items.OrderBy(s => s.StepNumber))
        {
            <li>
                <input type="checkbox" class="strike-toggle" />
                <span>@step.Description</span>
            </li>
        }
    </ol>
}


<a asp-controller="Recipe" asp-action="Index" class="btn btn-secondary">Back to List</a>
<a asp-controller="Recipe" asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning">Edit</a>
<a asp-controller="Recipe" asp-action="Delete" asp-route-idRecipe="@Model.Id" class="btn btn-danger">Delete</a>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.strike-toggle').forEach(function (checkbox) {
                checkbox.addEventListener('change', function () {
                    var span = this.nextElementSibling;
                    if (this.checked) {
                        span.style.textDecoration = 'line-through';
                        span.style.color = '#888';
                    } else {
                        span.style.textDecoration = '';
                        span.style.color = '';
                    }
                });
            });
        });
    </script>
}